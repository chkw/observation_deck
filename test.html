<!DOCTYPE html>
<html>
	<head>
		<title>Observation Deck Prototype</title>
		<meta charset="utf-8">
		<noscript>
			<div align="center">
				<p style="color:black;background-color:red;font-size:18pt">
					This website requires JavaScript.  Please turn on JavaScript and then <a href="">try it again</a>.
				</p>
			</div>
		</noscript>
		<link href="observation_deck/images/favicon.ico" rel="icon" type="image/x-icon">
		<link rel="stylesheet" href="observation_deck/css/observation_deck.css" type="text/css" />

		<script type="text/javascript" src="https://code.jquery.com/jquery-1.10.2.js"></script>
		<script type="text/javascript" src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

		<script type="text/javascript" src="observation_deck/scripts/bower_components/jQuery-contextMenu/src/jquery.contextMenu.js"></script>
		<link type="text/css" rel="stylesheet" href="observation_deck/scripts/bower_components/jQuery-contextMenu/src/jquery.contextmenu.css">

		<script type="text/javascript" src="observation_deck/scripts/bower_components/jstat/dist/jstat.min.js"></script>
		<script type="text/javascript" src="observation_deck/scripts/utils.js"></script>
		<script type="text/javascript" src="observation_deck/scripts/OD_eventData.js"></script>
		<script type="text/javascript" src="observation_deck/scripts/medbook_data_load.js"></script>
		<script type="text/javascript" src="observation_deck/scripts/a.js"></script>
		<script type="text/javascript" src="observation_deck/scripts/b.js"></script>
		<script type="text/javascript" src="observation_deck/scripts/c.js"></script>
		<script type="text/javascript" src="observation_deck/scripts/signatures.js"></script>
		<script type="text/javascript" src="observation_deck/scripts/observation_deck_3.js"></script>
		<!-- <script type="text/javascript" src="observation_deck/scripts/observation_deck_jqplugin.js"></script> -->
	</head>
	<body>
		<div id='testDiv'></div>
		<script>
            // var clinicalDataFileUrl = 'observation_deck/data/cbioMedbook/data_clinical.txt';
            // var caseListsFileUrl = 'observation_deck/data/cbioMedbook/getCaseLists.txt';
            // var mutationDataFileUrl = 'observation_deck/data/cbioMedbook/mutations.maf';
            // var expressionDataFileUrl = 'observation_deck/data/cbioMedbook/expressionData.tab';

            var divElem = document.getElementById("testDiv");

            // buildObservationDeck(divElem, {
            // 'clinicalUrl' : clinicalDataFileUrl,
            // 'mutationUrl' : mutationDataFileUrl,
            // 'expressionUrl' : expressionDataFileUrl
            // });

            // var clinicalResp = getResponse('observation_deck/data/meteorMedbook/clinicalData.json');
            // clinicalResp = parseJson(clinicalResp);
            //
            // var expressionResp = getResponse('observation_deck/data/meteorMedbook/expression50Data.json');
            // expressionResp = parseJson(expressionResp);

            // var signatureFile = 'observation_deck/data/meteorMedbook/smallcell-50.tab';
            // var AR_signatureFile = 'observation_deck/data/meteorMedbook/ar_sig.tab';

            eventAlbum = new eventData.OD_eventAlbum();
            // medbookDataLoader.getViperData('observation_deck/data/viper.tab', eventAlbum);

            obs_deck_config = buildObservationDeck(divElem, {
                'eventAlbum' : eventAlbum,
                'mongoData' : {
                    'clinical' : aaa,
                    'expression' : ccc
                },

                // 'signature' : {
                // 'expression' : {
                // 'object' : [smallCellSigEventObj, arSigEventObj]
                // }
                // },

                'signature_index' : {
                    'expression' : {
                        'object' : ar_sig_indexes
                    }
                },
                // 'deleteEvents' : ['Docetaxel'],
                "rowTitleCallback" : function(eventId, config) {
                    var eventObj = config['eventAlbum'].getEvent(eventId);
                    var datatype = eventObj.metadata['datatype'];
                    if (datatype === 'expression data') {
                        // mRNA url: /wb/gene/<gene name>
                        var gene = eventId.replace('_mRNA', '');
                        var url = '/wb/gene/' + gene;
                        window.open(url, "_self");
                    } else if (datatype === 'clinical data') {
                        // clinical url: /wb/clinical/<name>
                        var feature = eventId;
                        var url = '/wb/clinical/' + feature;
                        window.open(url, "_self");
                    }
                },
                "columnTitleCallback" : function(sampleId) {
                    var url = '/wb/patient/' + sampleId;
                    window.open(url, "_self");
                }
            });

            // buildObservationDeck(divElem, {
            // 'mongoData' : {
            // 'clinical' : a,
            // 'expression' : b
            // }
            // });
		</script>
	</body>
</html>